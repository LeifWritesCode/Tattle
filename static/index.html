<html>
    <head>
        <title>SSHamer</title>
        <link rel="stylesheet" href="leaflet.css">
        <script src="leaflet.js"></script>
        <script src="leaflet-heat.js"></script>
        <script src="jquery.min.js"></script>
    </head>
    <body>
        <div style="height: 100%;"id="map" class="leaflet-container leaflet-touch leaflet-retina leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom"></div>
        <script>

            var points = [];
            var map = L.map('map').setView([0, 0], 2);

            $.getJSON('/raw', (res) => {

                /* extract data and generate heat map points */
                for (var key in res) {
                    var addr = res[key];
                    points.push(addr.location.concat(addr.occurrences));
                }

                /* set up heatmap from received data points */
                var heat = L.heatLayer(points, {
                    radius: 25,
                    blur: 20
                }).addTo(map);

                /* set up map tiles */
                L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(map);
            });
        </script>
    </body>
</html>
